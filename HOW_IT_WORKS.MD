# –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–ª–∞—Å—Å—ã

## HttpServer

## üß± 1. –ò–º–ø–æ—Ä—Ç—ã

```java
import java.io.*;
import java.net.*;
import java.util.*;
import java.util.concurrent.*;
import org.slf4j.*;
import com.dandaev.edu.http.server.entities.*;
```

üîπ –ü–æ–¥–∫–ª—é—á–∞–µ–º –≤—Å—ë –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ:

* `java.io.*` ‚Äî —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å –ø–æ—Ç–æ–∫–æ–≤ (–∑–∞–ø—Ä–æ—Å/–æ—Ç–≤–µ—Ç);
* `java.net.*` ‚Äî —Å–µ—Ç–µ–≤—ã–µ —Å–æ–∫–µ—Ç—ã (TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è);
* `java.util.concurrent.*` ‚Äî –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤ (`ExecutorService`);
* `org.slf4j.*` ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ SLF4J;
* `com.dandaev.edu.http.server.entities.*` ‚Äî —Ç–≤–æ–∏ –∫–ª–∞—Å—Å—ã `HttpRequest` –∏ `HttpResponse`.

---

## ‚öôÔ∏è 2. –ü–æ–ª—è –∫–ª–∞—Å—Å–∞

```java
private static final Logger logger = LoggerFactory.getLogger(HttpServer.class);
private final int port;
private final ExecutorService threadPool;
private volatile boolean isRunning = false;
private ServerSocket serverSocket;
private Thread serverThread;
```

üîπ **`logger`** ‚Äî –¥–ª—è –ª–æ–≥–æ–≤ (–∏–Ω—Ñ–æ, –æ—à–∏–±–∫–∏, –¥–µ–±–∞–≥).
üîπ **`port`** ‚Äî –ø–æ—Ä—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —Å–µ—Ä–≤–µ—Ä —Å–ª—É—à–∞–µ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, 8080).
üîπ **`threadPool`** ‚Äî –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.
üîπ **`isRunning`** ‚Äî —Ñ–ª–∞–≥, —á—Ç–æ–±—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä.
üîπ **`serverSocket`** ‚Äî –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å–ª—É—à–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.
üîπ **`serverThread`** ‚Äî –ø–æ—Ç–æ–∫, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä (—á—Ç–æ–±—ã –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å `main`).

---

## üß© 3. –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã

```java
public HttpServer(int port) {
    this.port = port;
    this.threadPool = Executors.newFixedThreadPool(10);
}
```

–°–æ–∑–¥–∞—ë—Ç —Å–µ—Ä–≤–µ—Ä —Å –ø–æ—Ä—Ç–æ–º –∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø—É–ª–æ–º –∏–∑ 10 –ø–æ—Ç–æ–∫–æ–≤.

```java
public HttpServer(int port, int threadPoolSize) {
    this.port = port;
    this.threadPool = Executors.newFixedThreadPool(threadPoolSize);
}
```

–ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–¥–∞—Ç—å —Ä–∞–∑–º–µ—Ä –ø—É–ª–∞ –≤—Ä—É—á–Ω—É—é.

---

## üöÄ 4. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```java
public void start() {
    if (isRunning) {
        logger.warn("Server is already running");
        return;
    }

    serverThread = new Thread(this::runServer, "HTTP-Server-Thread");
    serverThread.start();
}
```

üîπ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω–µ –∑–∞–ø—É—â–µ–Ω –ª–∏ —Å–µ—Ä–≤–µ—Ä —É–∂–µ.
üîπ –°–æ–∑–¥–∞—ë—Ç **–Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫**, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –º–µ—Ç–æ–¥ `runServer()`.
üîπ –≠—Ç–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã —Å–µ—Ä–≤–µ—Ä —Å–ª—É—à–∞–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ**, –Ω–µ –±–ª–æ–∫–∏—Ä—É—è –æ—Å–Ω–æ–≤–Ω—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É.

---

## üß† 5. –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª —Å–µ—Ä–≤–µ—Ä–∞

```java
private void runServer() {
    try {
        serverSocket = new ServerSocket(port);
        serverSocket.setSoTimeout(1000); // —Ç–∞–π–º–∞—É—Ç 1 —Å–µ–∫—É–Ω–¥–∞
        isRunning = true;

        logger.info("HTTP Server started...");
        ...
```

üîπ –°–æ–∑–¥–∞—ë—Ç—Å—è TCP-—Å–æ–∫–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å–ª—É—à–∞–µ—Ç —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–æ—Ä—Ç.
üîπ –¢–∞–π–º–∞—É—Ç –Ω—É–∂–µ–Ω, —á—Ç–æ–±—ã `accept()` –Ω–µ –≤–∏—Å–µ–ª –≤–µ—á–Ω–æ, –∏ –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å `isRunning`.
üîπ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥ `isRunning = true`.

---

### üîÅ –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª:

```java
while (isRunning) {
    try {
        Socket clientSocket = serverSocket.accept();
        logger.debug("New connection from {}", clientSocket.getInetAddress());
        threadPool.submit(() -> processSocket(clientSocket));
```

üîπ `accept()` –∂–¥—ë—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞.
üîπ –ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è `Socket` –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å –∫–ª–∏–µ–Ω—Ç–æ–º.
üîπ –ö–∞–∂–¥—ã–π –∫–ª–∏–µ–Ω—Ç –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç—Å—è **–≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ –∏–∑ –ø—É–ª–∞** (`threadPool.submit(...)`).

---

### ‚ö†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π:

* `SocketTimeoutException` ‚Äî –ø—Ä–æ—Å—Ç–æ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Ü–∏–∫–ª.
* `IOException` ‚Äî –æ—à–∏–±–∫–∞ —Å–µ—Ç–∏, –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è.

–í `finally` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `stop()` ‚Äî —á—Ç–æ–±—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Å–µ—Ä–≤–µ—Ä.

---

## üõë 6. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

```java
public void stop() {
    if (!isRunning) return;
    isRunning = false;
    logger.info("Shutting down HTTP server...");
```

üîπ –í—ã–∫–ª—é—á–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä:
‚Äî –∑–∞–∫—Ä—ã–≤–∞–µ—Ç `ServerSocket`,
‚Äî –∑–∞–≤–µ—Ä—à–∞–µ—Ç –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤,
‚Äî –¥–æ–∂–∏–¥–∞–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á (–¥–æ 5 —Å–µ–∫—É–Ω–¥),
‚Äî –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç (`shutdownNow()`).

---

## üì° 7. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞

```java
private void processSocket(Socket socket) {
    try (socket;
         var reader = new BufferedReader(new InputStreamReader(socket.getInputStream()));
         var writer = new PrintWriter(new OutputStreamWriter(socket.getOutputStream()), true)) {
```

üîπ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `try-with-resources`, —á—Ç–æ–±—ã —Å–æ–∫–µ—Ç –∏ –ø–æ—Ç–æ–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞–ª–∏—Å—å.
üîπ `reader` ‚Äî —á–∏—Ç–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∫–ª–∏–µ–Ω—Ç–∞.
üîπ `writer` ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç.

---

### –ß–∏—Ç–∞–µ–º –∑–∞–ø—Ä–æ—Å:

```java
HttpRequest httpRequest = parseHttpRequest(reader);
```

–ü–∞—Ä—Å–∏–º –∑–∞–≥–æ–ª–æ–≤–∫–∏, –º–µ—Ç–æ–¥, –ø—É—Ç—å –∏ —Ç–µ–ª–æ.

---

### –õ–æ–≥–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º:

```java
HttpResponse httpResponse = handleHttpRequest(httpRequest);
sendHttpResponse(writer, httpResponse);
```

üîπ –§–æ—Ä–º–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `GET`, `POST`, –∏ —Ç.–¥.).
üîπ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –µ–≥–æ –∫–ª–∏–µ–Ω—Ç—É.

---

## üßæ 8. –ü–∞—Ä—Å–∏–Ω–≥ HTTP-–∑–∞–ø—Ä–æ—Å–∞

```java
String requestLine = reader.readLine(); // "GET /index.html HTTP/1.1"
String[] requestParts = requestLine.split(" ", 3);
```

–†–∞–∑–¥–µ–ª—è–µ–º —Å—Ç—Ä–æ–∫—É –Ω–∞:

* `method` ‚Äî GET / POST / PUT / DELETE
* `path` ‚Äî –ø—É—Ç—å
* `version` ‚Äî HTTP/1.1

---

–ó–∞—Ç–µ–º —á–∏—Ç–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏:

```java
while ((headerLine = reader.readLine()) != null && !headerLine.isEmpty()) {
    int colonIndex = headerLine.indexOf(':');
    ...
    request.addHeader(key, value);
}
```

---

–ï—Å–ª–∏ –µ—Å—Ç—å `Content-Length`, —á–∏—Ç–∞–µ–º —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, JSON –∏–ª–∏ —Ñ–æ—Ä–º—É).
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 1 MB ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏—Ö —Ç–µ–ª.

---

## üßÆ 9. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞

```java
private HttpResponse handleHttpRequest(HttpRequest request)
```

üîπ –°–º–æ—Ç—Ä–∏–º –º–µ—Ç–æ–¥ (`GET`, `POST`, `PUT`, `DELETE`, `HEAD`)
üîπ –î–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—ã–∑—ã–≤–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ (`handleGetRequest()`, –∏ —Ç.–¥.).
üîπ –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ–º 405.

---

## üåê 10. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### üü¢ GET

```java
if ("/".equals(path)) { ... }
else if ("/time".equals(path)) { ... }
else if ("/info".equals(path)) { ... }
else { 404 }
```

‚Äî `/` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç HTML
‚Äî `/time` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –≤ JSON
‚Äî `/info` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ—Ä–≤–µ—Ä–µ

---

### üü° POST

```java
if ("/echo".equals(path)) { ... }
else if ("/api/data".equals(path)) { ... }
else { 404 }
```

‚Äî `/echo` –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ —Ç–µ–ª–æ
‚Äî `/api/data` –∏–º–∏—Ç–∏—Ä—É–µ—Ç –ø—Ä–∏—ë–º –¥–∞–Ω–Ω—ã—Ö API

---

### üîµ PUT / DELETE

```java
if (path.startsWith("/api/resources/")) { ... }
else { 404 }
```

‚Äî –ø—Ä–æ—Å—Ç–∞—è –∏–º–∏—Ç–∞—Ü–∏—è REST API (`/api/resources/{id}`)

---

### ‚ö™ HEAD

–¢–æ –∂–µ, —á—Ç–æ `GET`, –Ω–æ –±–µ–∑ —Ç–µ–ª–∞ (`response.setBody("")`).

---

## üì§ 11. –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞

```java
writer.print(response.getVersion() + " " + response.getStatusCode() + " " + response.getStatusMessage() + "\r\n");
```

üîπ –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî —Å—Ç–∞—Ç—É—Å (`HTTP/1.1 200 OK`)
üîπ –î–∞–ª–µ–µ –≤—Å–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
üîπ –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
üîπ –ü–æ—Ç–æ–º —Ç–µ–ª–æ (–µ—Å–ª–∏ –µ—Å—Ç—å)

`writer.flush()` ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å—ë –∫–ª–∏–µ–Ω—Ç—É.

---

## üß≠ 12. –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∑–∞–ø—Ä–æ—Å–∞

```
–ö–ª–∏–µ–Ω—Ç -> –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è -> –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å
    ‚Üì
ServerSocket.accept()
    ‚Üì
processSocket()
    ‚Üì
parseHttpRequest()
    ‚Üì
handleHttpRequest()
    ‚Üì
sendHttpResponse()
    ‚Üì
Client –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç
```

---

## SimpleHttpClient

–û—Ç–ª–∏—á–Ω–æ üëç
–¢–µ–ø–µ—Ä—å —Ç—ã –ø–æ–∫–∞–∑–∞–ª **HTTP-–∫–ª–∏–µ–Ω—Ç**, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ç–µ–º —Å–∞–º—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º, —á—Ç–æ —Ç—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª —Ä–∞–Ω–µ–µ.
–≠—Ç–æ –æ—á–µ–Ω—å –º–æ—â–Ω–∞—è —Å–≤—è–∑–∫–∞: —Å–≤–æ–π HTTP-—Å–µ—Ä–≤–µ—Ä + —Å–≤–æ–π –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API.
–†–∞–∑–±–µ—Ä—ë–º –≤—Å—ë **–ø–æ —á–∞—Å—Ç—è–º**, —á—Ç–æ–±—ã —Å—Ç–∞–ª–æ –∫—Ä–∏—Å—Ç–∞–ª—å–Ω–æ –ø–æ–Ω—è—Ç–Ω–æ, **—á—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞** –∏ **–∑–∞—á–µ–º –æ–Ω–∞ –Ω—É–∂–Ω–∞**.

---

## üß± 1. –ò–º–ø–æ—Ä—Ç—ã

```java
import java.io.IOException;
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;
import java.nio.file.*;
import java.time.Duration;
import java.util.*;
import java.util.concurrent.*;
```

üîπ –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

* `HttpClient`, `HttpRequest`, `HttpResponse` ‚Äî –Ω–æ–≤—ã–π HTTP API –∏–∑ Java 11.
* `Files`, `Paths` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏.
* `ExecutorService` ‚Äî –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤.
* `Scanner` ‚Äî –≤–≤–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
* `Duration` ‚Äî –¥–ª—è –∑–∞–¥–∞–Ω–∏—è —Ç–∞–π–º–∞—É—Ç–æ–≤.

---

## ‚öôÔ∏è 2. –ü–æ–ª—è –∫–ª–∞—Å—Å–∞

```java
private static final HttpClient httpClient = HttpClient.newBuilder()
        .version(HttpClient.Version.HTTP_1_1)
        .connectTimeout(Duration.ofSeconds(10))
        .build();
```

üîπ –°–æ–∑–¥–∞—ë–º **–≥–ª–æ–±–∞–ª—å–Ω—ã–π HTTP-–∫–ª–∏–µ–Ω—Ç** —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:

* HTTP/1.1 (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ç–≤–æ–∏–º —Å–µ—Ä–≤–µ—Ä–æ–º);
* —Ç–∞–π–º–∞—É—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è 10 —Å–µ–∫—É–Ω–¥;
* –æ–±—ä–µ–∫—Ç ‚Äî **singleton**, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å–µ–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏.

---

```java
private static ExecutorService executor = Executors.newFixedThreadPool(3);
```

üîπ –ü—É–ª –∏–∑ 3 –ø–æ—Ç–æ–∫–æ–≤ ‚Äî –¥–ª—è **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤** –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

---

## üèÅ 3. –ú–µ—Ç–æ–¥ `main()`

```java
public static void main(String[] args) {
    if (args.length == 0) {
        startInteractiveMode();
    } else {
        executeCommand(args[0]);
    }

    shutdown();
}
```

üîπ –ï—Å–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø—É—â–µ–Ω–∞ **–±–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤** ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç **–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é**.
üîπ –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω –∞—Ä–≥—É–º–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, `"test"` –∏–ª–∏ `"all"`) ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç **—Ä–µ–∂–∏–º –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏**.
üîπ –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç `shutdown()` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ—Ç–æ–∫–æ–≤.

---

## üí¨ 4. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º

```java
private static void startInteractiveMode() {
    Scanner scanner = new Scanner(System.in);
```

üîπ –ó–∞–ø—É—Å–∫–∞–µ—Ç **–º–µ–Ω—é –≤ –∫–æ–Ω—Å–æ–ª–∏**, –≥–¥–µ –º–æ–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã.

---

### –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:

```java
System.out.println("‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó");
System.out.println("‚ïë      HTTP Client for Testing         ‚ïë");
System.out.println("‚ïë         Server: localhost:8081       ‚ïë");
System.out.println("‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù");
```

(—á–∏—Å—Ç–æ –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã üôÇ)

---

### –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª:

```java
while (true) {
    printMenu();
    System.out.print("\nEnter command number or name: ");
```

üîπ –ö–∞–∂–¥—ã–π —Ä–∞–∑ –ø–µ—á–∞—Ç–∞–µ—Ç –º–µ–Ω—é –∏ –∂–¥—ë—Ç –≤–≤–æ–¥–∞ –∫–æ–º–∞–Ω–¥—ã.

---

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–æ–¥–∞:

```java
switch (input.toLowerCase()) {
    case "1":
    case "all":
        sendAllRequests();
        waitForCompletion();
        break;
    ...
```

üîπ –ú–æ–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å **–Ω–æ–º–µ—Ä –∏–ª–∏ —Å–ª–æ–≤–æ** –∫–æ–º–∞–Ω–¥—ã.
üîπ –ü—Ä–∏–º–µ—Ä: `1` –∏–ª–∏ `all` ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∏–∑ –ø–∞–ø–∫–∏.
üîπ `exit` –∑–∞–≤–µ—Ä—à–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç.

---

### –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞:

```java
System.out.println("‚ùå Unknown command: " + input);
```

–ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ ‚Äî –≤—ã–≤–æ–¥–∏—Ç—Å—è –ø–æ–¥—Å–∫–∞–∑–∫–∞.

---

## üßæ 5. –ú–µ–Ω—é

```java
private static void printMenu() {
    System.out.println("\nüìã Available commands:");
    System.out.println("1. all    - Send all requests...");
    ...
}
```

üîπ –ü—Ä–æ—Å—Ç–æ –≤—ã–≤–æ–¥–∏—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥.

---

## üìÅ 6. –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏

–ö–æ–º–∞–Ω–¥–∞ `file` ‚Äî –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–±—Ä–∞—Ç—å **–æ–¥–∏–Ω JSON-—Ñ–∞–π–ª** –∏–∑ –ø–∞–ø–∫–∏ `resources/requests`.

```java
private static void handleFileCommand(Scanner scanner) {
    System.out.print("Enter filename (without .json extension): ");
    ...
}
```

–ï—Å–ª–∏ –∏–º—è –≤–≤–µ–¥–µ–Ω–æ ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å.

---

## üß∞ 7. –†–µ–∂–∏–º –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

```java
private static void executeCommand(String command) {
    switch (command.toLowerCase()) {
        case "all": sendAllRequests(); break;
        case "test": sendTestRequests(); break;
        case "list": listAvailableFiles(); return;
        ...
```

üîπ –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ **–±–µ–∑ –º–µ–Ω—é**, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```
java -jar client.jar all
```

---

## ‚è≥ 8. –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

```java
private static void waitForCompletion() {
    executor.shutdown();
    if (!executor.awaitTermination(30, TimeUnit.SECONDS)) {
        System.out.println("‚è∞ Timeout...");
    }
    executor = Executors.newFixedThreadPool(3);
}
```

üîπ –î–æ–∂–∏–¥–∞–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (–¥–æ 30 —Å–µ–∫—É–Ω–¥).
üîπ –ü–æ—Ç–æ–º –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç –ø—É–ª –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–µ–∞–Ω—Å–∞.

---

## üîå 9. –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ

```java
private static void shutdown() {
    if (executor != null) executor.shutdownNow();
}
```

üîπ –ü—Ä–µ—Ä—ã–≤–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã.

---

## üì§ 10. –û—Ç–ø—Ä–∞–≤–∫–∞ –≤—Å–µ—Ö JSON-—Ñ–∞–π–ª–æ–≤

```java
private static void sendAllRequests() {
    Path requestsDir = Paths.get("resources", "requests");
```

üîπ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –ø–∞–ø–∫–∏.
üîπ –ï—Å–ª–∏ –µ—ë –Ω–µ—Ç ‚Äî —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–∏–º–µ—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã (`createSampleFiles()`).

---

```java
var files = Files.list(requestsDir)
        .filter(path -> path.toString().endsWith(".json"))
        .toList();
```

üîπ –°–∫–∞–Ω–∏—Ä—É–µ—Ç –ø–∞–ø–∫—É –∏ –≤—ã–±–∏—Ä–∞–µ—Ç –≤—Å–µ `.json` —Ñ–∞–π–ª—ã.

---

```java
for (Path file : files) {
    executor.submit(() -> sendRequestFromFile(file));
}
```

üîπ –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª ‚Äî —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π HTTP-–∑–∞–ø—Ä–æ—Å.
üîπ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ.

---

## ü™∂ 11. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–æ–≤ JSON-—Ñ–∞–π–ª–æ–≤

```java
private static void createSampleFiles() {
    Path requestsDir = Paths.get("resources", "requests");
    Files.createDirectories(requestsDir);
```

üîπ –°–æ–∑–¥–∞—ë—Ç –ø–∞–ø–∫—É, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç.
üîπ –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ç—É–¥–∞ –ø—Ä–∏–º–µ—Ä—ã JSON-—Ñ–∞–π–ª–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ (`get-home.json`, `post-echo.json` –∏ —Ç. –¥.).

–ö–∞–∂–¥—ã–π —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON), —á—Ç–æ–±—ã —Å–µ—Ä–≤–µ—Ä –º–æ–≥ —á—Ç–æ-—Ç–æ –ø–æ–ª—É—á–∏—Ç—å.

---

## üì© 12. –û—Ç–ø—Ä–∞–≤–∫–∞ –æ–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

```java
private static void sendSingleRequest(String fileName) {
    if (!fileName.endsWith(".json")) fileName += ".json";
    Path filePath = Paths.get("resources", "requests", fileName);
```

üîπ –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É.
üîπ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –æ–Ω.
üîπ –ï—Å–ª–∏ –¥–∞ ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç `sendRequestFromFile(filePath)`.

---

## üßæ 13. –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

```java
private static void listAvailableFiles() {
    Path requestsDir = Paths.get("resources", "requests");
    ...
}
```

üîπ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ `.json` —Ñ–∞–π–ª–æ–≤.
üîπ –ï—Å–ª–∏ –∏—Ö –Ω–µ—Ç ‚Äî —Å–æ–≤–µ—Ç—É–µ—Ç —Å–æ–∑–¥–∞—Ç—å —Å –ø–æ–º–æ—â—å—é `create`.

---

## üß™ 14. –¢–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã

```java
private static void sendTestRequests() {
    System.out.println("üß™ Sending test requests...");
```

üîπ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–±–æ—Ä **–ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤** –∫ —Ç–≤–æ–µ–º—É —Å–µ—Ä–≤–µ—Ä—É:

* `GET /`, `/time`, `/info`
* `POST /echo`
* `PUT /api/resources/999`
* `DELETE /api/resources/888`
* `HEAD /`

‚Äî –≤—Å—ë —ç—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É —Ç–≤–æ–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞.

---

## üß± 15. –†–µ–∞–ª—å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞

```java
private static void sendTestRequest(String method, String endpoint, String body) {
    executor.submit(() -> {
        HttpRequest request = buildRequest(method, "http://localhost:8081" + endpoint, body);
        HttpResponse<String> response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());
        printResponse(response, method + " " + endpoint);
    });
}
```

üîπ –°–æ–∑–¥–∞—ë—Ç HTTP-–∑–∞–ø—Ä–æ—Å (—á–µ—Ä–µ–∑ `buildRequest`)
üîπ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–º `httpClient.send(...)`
üîπ –ü–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç –∏ –ø–µ—á–∞—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ `printResponse()`.

---

## üß∞ 16. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ –∏ endpoint –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞

```java
private static String getMethodFromFileName(String fileName)
```

üîπ –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `post-` ‚Üí –º–µ—Ç–æ–¥ `POST`,
—Å `put-` ‚Üí `PUT`, –∏ —Ç.–¥.
–ò–Ω–∞—á–µ `GET`.

---

```java
private static String getEndpointFromFileName(String fileName)
```

üîπ –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏–º—è —Ñ–∞–π–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `post-echo.json`) ‚Üí –ø—É—Ç—å `/echo`.
üîπ –≠—Ç–æ –¥–∞—ë—Ç —É–¥–æ–±–Ω–æ–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏ –∏ API-—ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏.

---

## üèóÔ∏è 17. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞

```java
private static HttpRequest buildRequest(String method, String url, String body) {
    HttpRequest.Builder builder = HttpRequest.newBuilder()
            .uri(URI.create(url))
            .header("Content-Type", "application/json")
            .header("User-Agent", "SimpleHttpClient/1.0")
            .timeout(Duration.ofSeconds(30));
```

üîπ –°–æ–∑–¥–∞—ë—Ç **HTTP-–∑–∞–ø—Ä–æ—Å** —Å –Ω—É–∂–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏.
üîπ –î–æ–±–∞–≤–ª—è–µ—Ç —Ç–µ–ª–æ (–µ—Å–ª–∏ POST/PUT) –∏–ª–∏ –±–µ–∑ —Ç–µ–ª–∞ (GET/HEAD/DELETE).

---

## üñ®Ô∏è 18. –ü–µ—á–∞—Ç—å –æ—Ç–≤–µ—Ç–∞

```java
private static void printResponse(HttpResponse<String> response, String requestInfo) {
```

üîπ –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∫—Ä–∞—Å–∏–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏:

* —Ä–∏—Å—É–µ—Ç —Ä–∞–º–∫—É;
* –æ–∫—Ä–∞—à–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å (200 ‚Üí –∑–µ–ª—ë–Ω—ã–π, 404 ‚Üí –∫—Ä–∞—Å–Ω—ã–π –∏ —Ç.–¥.);
* –≤—ã–≤–æ–¥–∏—Ç —Ç–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ (–ø—ã—Ç–∞–µ—Ç—Å—è "–ø—Ä–∏—É–∫—Ä–∞—Å–∏—Ç—å" JSON –æ—Ç—Å—Ç—É–ø–∞–º–∏).

---

```java
private static String getColorForStatus(int statusCode) {
    if (statusCode >= 200 && statusCode < 300) return "\u001B[32m"; // –∑–µ–ª–µ–Ω—ã–π
    ...
}
```

üîπ ANSI-–∫–æ–¥—ã –¥–ª—è –æ–∫—Ä–∞—Å–∫–∏ —Ç–µ–∫—Å—Ç–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏.

---

## ‚öôÔ∏è 19. –í—Å—è –ª–æ–≥–∏–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

üì¶ –ü–∞–ø–∫–∞ `resources/requests` ‚Üí —Ö—Ä–∞–Ω–∏—Ç JSON-—Ç–µ–ª–∞.
üì§ –ö–ª–∏–µ–Ω—Ç —á–∏—Ç–∞–µ—Ç –∏—Ö ‚Üí –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–µ—Ç–æ–¥ –∏ –ø—É—Ç—å ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç HTTP-–∑–∞–ø—Ä–æ—Å ‚Üí —Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç.
üì• –ö–ª–∏–µ–Ω—Ç –≤—ã–≤–æ–¥–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

---

## üîÅ 20. –û–±—â–∞—è —Å—Ö–µ–º–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ SimpleClient ‚îÇ
‚îÇ   (menu)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
  buildRequest()
       ‚îÇ
       ‚ñº
 send(HttpRequest)
       ‚îÇ
       ‚ñº
  ServerSocket (HttpServer)
       ‚îÇ
       ‚ñº
 handleHttpRequest()
       ‚îÇ
       ‚ñº
 sendHttpResponse()
       ‚îÇ
       ‚ñº
 printResponse()
```

---

## ServerApplication

–û—Ç–ª–∏—á–Ω–æ üëç
–¢—ã –ø–æ–∫–∞–∑–∞–ª –∫–ª–∞—Å—Å **`ServerApplication`**, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è **—Ç–æ—á–∫–æ–π –≤—Ö–æ–¥–∞ (main)** –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ—Å—Ç–æ–≥–æ HTTP-—Å–µ—Ä–≤–µ—Ä–∞.
–†–∞–∑–±–µ—Ä—ë–º **–ø–æ–¥—Ä–æ–±–Ω–æ –∏ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ**, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏ –∑–∞—á–µ–º.

---

## üì¶ –ü–∞–∫–µ—Ç –∏ –∏–º–ø–æ—Ä—Ç—ã

```java
package com.dandaev.edu.http;

import java.util.Scanner;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import com.dandaev.edu.http.server.HttpServer;
```

* `package ...` ‚Äî —É–∫–∞–∑—ã–≤–∞–µ—Ç, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —ç—Ç–æ—Ç –∫–ª–∞—Å—Å –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ø—Ä–æ–µ–∫—Ç–∞.
* `Scanner` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —á—Ç–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏.
* `Logger`, `LoggerFactory` ‚Äî –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ **SLF4J**, –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –æ—à–∏–±–æ–∫, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π).
* `HttpServer` ‚Äî —ç—Ç–æ —Ç–≤–æ–π **–∫–ª–∞—Å—Å —Å–µ—Ä–≤–µ—Ä–∞**, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç HTTP-–∑–∞–ø—Ä–æ—Å—ã (—Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –∏–∑ `com.dandaev.edu.http.server.HttpServer`).

---

## üß± –ü–æ–ª—è –∫–ª–∞—Å—Å–∞

```java
private static final Logger logger = LoggerFactory.getLogger(ServerApplication.class);
private static HttpServer server;
```

* `logger` ‚Äî —Å–æ–∑–¥–∞—ë—Ç –ª–æ–≥–≥–µ—Ä, —á—Ç–æ–±—ã —É–¥–æ–±–Ω–æ –ø–∏—Å–∞—Ç—å –≤ –∫–æ–Ω—Å–æ–ª—å –∏–ª–∏ —Ñ–∞–π–ª:
  –Ω–∞–ø—Ä–∏–º–µ—Ä, `logger.info("Server started")` –∏–ª–∏ `logger.error("Something failed")`.
* `server` ‚Äî –æ–±—ä–µ–∫—Ç —Ç–≤–æ–µ–≥–æ HTTP-—Å–µ—Ä–≤–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º –ø–æ—Ä—Ç—É.

---

## üöÄ –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞

```java
public static void main(String[] args) {
```

–ì–ª–∞–≤–Ω—ã–π –º–µ—Ç–æ–¥, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã.

---

### 1Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä—Ç–∞

```java
int port = 8081;
```

‚Äî –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–µ—Ä–≤–µ—Ä —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç **8081**.

---

### 2Ô∏è‚É£ –ß—Ç–µ–Ω–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

```java
if (args.length > 0) {
	try {
		port = Integer.parseInt(args[0]);
	} catch (NumberFormatException e) {
		logger.warn("Invalid port number: {}. Using default port: {}", args[0], port);
	}
}
```

* –ï—Å–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–ø—É—â–µ–Ω–∞ —Å –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä:

  ```
  java -jar server.jar 9090
  ```

  ‚Äî —Ç–æ –ø–æ—Ä—Ç –≤–æ–∑—å–º—ë—Ç—Å—è –∏–∑ `args[0]`.
* –ï—Å–ª–∏ —ç—Ç–æ –Ω–µ —á–∏—Å–ª–æ ‚Äî –≤—ã–≤–æ–¥–∏—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –∏ –æ—Å—Ç–∞—ë—Ç—Å—è –ø–æ—Ä—Ç **8081**.

---

### 3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–æ—Ä—Ç–∞

```java
if (port < 1 || port > 65535) {
	logger.error("Port must be between 1 and 65535");
	System.exit(1);
}
```

–ü–æ—Ä—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ **1‚Äì65535**, –∏–Ω–∞—á–µ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π.

---

### 4Ô∏è‚É£ –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ —Å–µ—Ä–≤–µ—Ä–∞

```java
server = new HttpServer(port);
```

‚Äî —Å–æ–∑–¥–∞—ë—Ç –æ–±—ä–µ–∫—Ç —Ç–≤–æ–µ–≥–æ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ `HttpServer`,
–∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–ª—É—à–∞—Ç—å —ç—Ç–æ—Ç –ø–æ—Ä—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã.

---

### 5Ô∏è‚É£ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ **shutdown hook**

```java
Runtime.getRuntime().addShutdownHook(new Thread(() -> {
	logger.info("Received shutdown signal");
	if (server != null) {
		server.stop();
	}
}));
```

–≠—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π **"—Ö—É–∫" (hook)**, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã
(–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ `Ctrl+C` –∏–ª–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞).
–û–Ω –∞–∫–∫—É—Ä–∞—Ç–Ω–æ **–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä**, —á—Ç–æ–±—ã –æ—Å–≤–æ–±–æ–¥–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã –∏ –ø–æ—Ä—Ç—ã.

---

### 6Ô∏è‚É£ –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ

```java
Thread serverThread = new Thread(() -> {
	try {
		server.start();
	} catch (Exception e) {
		logger.error("Server stopped with error", e);
		System.exit(1);
	}
}, "Server-Main-Thread");

serverThread.start();
```

* –°–æ–∑–¥–∞—ë—Ç—Å—è **–Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫**, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç –º–µ—Ç–æ–¥ `server.start()`.
* –≠—Ç–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã —Å–µ—Ä–≤–µ—Ä —Å–ª—É—à–∞–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ**,
  –∞ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ –º–æ–≥ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
* –ü–æ—Ç–æ–∫ –ø–æ–ª—É—á–∞–µ—Ç –∏–º—è `"Server-Main-Thread"` (—É–¥–æ–±–Ω–æ –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ).

---

### 7Ô∏è‚É£ –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

```java
try {
	Thread.sleep(1000);
} catch (InterruptedException e) {
	Thread.currentThread().interrupt();
}
```

–î–∞—ë—Ç —Å–µ—Ä–≤–µ—Ä—É **1 —Å–µ–∫—É–Ω–¥—É**, —á—Ç–æ–±—ã —É—Å–ø–µ—Ç—å –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –Ω–∞—á–Ω—É—Ç—Å—è –¥—Ä—É–≥–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏.
–ï—Å–ª–∏ –ø–æ—Ç–æ–∫ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ñ–ª–∞–≥ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è.

---

### 8Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞, –∑–∞–ø—É—â–µ–Ω –ª–∏ —Å–µ—Ä–≤–µ—Ä

```java
if (!server.isRunning()) {
	logger.error("Server failed to start on port {}", port);
	System.exit(1);
}
```

–ï—Å–ª–∏ –º–µ—Ç–æ–¥ `server.isRunning()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `false`,
–∑–Ω–∞—á–∏—Ç —Å–µ—Ä–≤–µ—Ä –Ω–µ —Å–º–æ–≥ —Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Ä—Ç –∑–∞–Ω—è—Ç) ‚Üí –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è.

---

### 9Ô∏è‚É£ –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

```java
startConsoleInterface();
```

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞ —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç,
–∏ —Ç–µ–ø–µ—Ä—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç **–≤–≤–æ–¥–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –≤—Ä—É—á–Ω—É—é**.

---

## üñ•Ô∏è –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

```java
private static void startConsoleInterface() {
	Scanner scanner = new Scanner(System.in);
	System.out.println("Server is running. Commands: [stop, quit, exit]");
```

* –°–æ–∑–¥–∞—ë—Ç—Å—è `Scanner` –¥–ª—è —á—Ç–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏.
* –í—ã–≤–æ–¥–∏—Ç—Å—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –ø–æ–¥—Å–∫–∞–∑–∫–∞.

---

### üîÑ –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª

```java
while (server.isRunning()) {
	try {
		System.out.print("> ");
		String command = scanner.nextLine().trim().toLowerCase();
```

–ü–æ–∫–∞ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω, –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∂–¥—ë—Ç –∫–æ–º–∞–Ω–¥—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–≤–µ—Å—Ç–∏ `stop`, `exit`, `status` –∏ —Ç.–ø.

---

### ‚öôÔ∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥

```java
switch (command) {
	case "stop":
	case "quit":
	case "exit":
		logger.info("Received stop command from console");
		server.stop();
		break;
	case "status":
		System.out.println("Server is " + (server.isRunning() ? "running" : "stopped"));
		break;
	case "":
		break;
	default:
		System.out.println("Unknown command: " + command);
		System.out.println("Available commands: stop, quit, exit, status");
}
```

* `stop / quit / exit` ‚Äî –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä.
* `status` ‚Äî –≤—ã–≤–æ–¥–∏—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.
* –ü—É—Å—Ç–æ–π –≤–≤–æ–¥ ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç.
* –õ—é–±–∞—è –¥—Ä—É–≥–∞—è –∫–æ–º–∞–Ω–¥–∞ ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ.

---

### üßπ –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

```java
scanner.close();
logger.info("Console interface stopped");
```

–ö–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è `Scanner`,
–∏ –≤ –ª–æ–≥ –ø–∏—à–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.

---

## üß† –ö—Ä–∞—Ç–∫–∏–π –∏—Ç–æ–≥

| –≠—Ç–∞–ø                | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç                             |
| ------------------- | -------------------------------------- |
| üîπ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä—Ç–∞  | –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –≥–¥–µ —Å–ª—É—à–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è     |
| üîπ –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ `HttpServer`  |
| üîπ –ó–∞–ø—É—Å–∫ –≤ –ø–æ—Ç–æ–∫–µ  | –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–µ—Ä–≤–µ—Ä—É —Ä–∞–±–æ—Ç–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ  |
| üîπ Shutdown Hook    | –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ       |
| üîπ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ | –£–±–µ–∂–¥–∞–µ—Ç—Å—è, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä —Ä–µ–∞–ª—å–Ω–æ –∑–∞–ø—É—â–µ–Ω |
| üîπ –ö–æ–Ω—Å–æ–ª—å          | –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—Ä—É—á–Ω—É—é —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–µ—Ä–≤–µ—Ä–æ–º   |

---
